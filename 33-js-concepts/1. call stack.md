가장 대중적인 자바스크립트 엔진은 google의 V8 엔진이다.
chrome과 node안에서 동작한다. 

![[Pasted image 20230102155908.png]]
Memory Heap - 객체는 힙, 대부분 구조화되지 않은 메모리 영역에 할당된다.

Call Stack - 코드가 실행될 때 호출 스택이 쌓인다. 

javaScript는 단일 스레드 프로그래밍 언어이므로, 단일 호출 스택이 있다.
단일 호출 스택이 있다는 말은 한 번에 하나의 일만 처리할 수 있다는 뜻이다. 

## 호출 스택(Call Stack)

프로그램에서 우리가 어디에 있는지를 기본적으로 기록하는 데이터 구조이다. 

함수를 실행하면 해당 함수의 기록을 스택 맨 위에 추가(Push)한다. 
함수를 결과 값을 반환하면 스택에 쌓여있던 함수는 제거(Pop)됩니다.

### 단일 호출 스택의 문제점 

Q. 자바스크립트에서는 하나의 호출 스택만 있기 때문에, 하나의 함수 처리가 엄청 느려서 다른 함수 실행에 지장을 줄 때는 어떻게 해야 할까?

A. 비동기 콜백(Asynchronous callbacks)을 사용한다. 즉, 우리의 코드 일부를 실행하고 나중에 실행될 콜백함수를 제공한다.

## Event Queue와 Async callback의 처리과정

자바스크립트 실행환경(Runtime)은 이벤트 큐(Event Queue)를 가지고 있다. 이는 처리할 메시지 목록과 실행할 콜백 함수 들의 리스트이다.

![[Pasted image 20230103131256.png]]
1. 버튼 클릭 같은 이벤트가 발생하면 비동기 함수는 c++로 구현된 web API를 호출하며, web API는 콜백 함수를 callback queue에 밀어 넣는다. 
2. 콜백 큐는 대기하다가 스택이 텅 비어버리는 시점에서 이벤트 루프를 돌린다. 
3. 이벤트 루프의 기본 역할은 큐와 스택, 두 부분을 지켜보다가 스택이 비는 시점에 콜백을 실행시켜 주는 것. 각 메시지와 콜백은 다른 메시지가 처리되기 전에 완전히 처리됩니다.


웹 브라우저에서는 이벤트가 발생할 때마다 메시지가 추가되고 이벤트 리스너가 첨부됩니다. 따라서 리스너가 없으면 이벤트가 손실됩니다. 콜백 함수의 호출은 호출 스택의 초기 프레임으로 사용되며, 자바스크립트가 싱글 스레드이므로 스택에 대한 모든 호출이 반환될 때까지 메세지 폴링(polling) 및 처리가 중지됩니다. 동기식 함수 호출은 이와 반대로 새 호출 프레임을 스택에 추가합니다.

https://new93helloworld.tistory.com/361

